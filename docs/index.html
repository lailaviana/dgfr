<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="This package provides tools for analyzing the sequence diversity of gene families. It includes functions for sequence alignment, diversity measurement, and visualization of gene family relationships. The package is designed to assist researchers in exploring and visualizing gene families.">
<title>Analyze Sequence Diversity Of Gene Families • dgfr</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Analyze Sequence Diversity Of Gene Families">
<meta property="og:description" content="This package provides tools for analyzing the sequence diversity of gene families. It includes functions for sequence alignment, diversity measurement, and visualization of gene family relationships. The package is designed to assist researchers in exploring and visualizing gene families.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">dgfr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lailaviana/dgfr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="dgfr-package-">dgfr package <img src="reference/figures/dgfR.png" align="right" width="120px"><a class="anchor" aria-label="anchor" href="#dgfr-package-"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The purpose of the dgfr package is to enable the visualization of sequence diversity within gene/protein families. In addition, it is also possible to determine the optimal number of clusters for grouping members of gene families based on sequence similarity and to calculate the mean/median similarity inside each cluster.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Before proceeding to the installation of the dgfr package, you must install the following dependencies:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"Biostrings"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Now you can install the <code>dgfr</code> package using the following command:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="co">#devtools::install_github("lailaviana/dgfr")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lailaviana/dgfr" class="external-link">dgfr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-to-use">How to use?<a class="anchor" aria-label="anchor" href="#how-to-use"></a>
</h2>
<ol style="list-style-type: decimal">
<li>First, retrieve the FASTA sequences of the gene family being studied from the database of your choice. The fasta file must be loaded inside R using the Biostrings::readAAStringSet() in case of protein sequences or Biostrings::readDNAStringSet() in case of nucleotide sequences.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fasta_file</span> <span class="op">&lt;-</span> <span class="fu">Biostrings</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-io.html" class="external-link">readAAStringSet</a></span><span class="op">(</span><span class="st">"data-raw/tcmuc_fasta"</span><span class="op">)</span></span></code></pre></div>
<p>If you prefer, you might use a sample dataset provided by the package. The dataset is named <code>fasta</code> and contains 75 protein sequences and you can load it using the following command:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fasta_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tcmuc_fasta</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>The object containing your fasta should be provided to the first function named <code>get_alignment_score</code>, then you should also provide the type o sequence “nuc” for nucleotide or “prot” for protein, the alignment method (“global” or “local”) and the number of cores to be used in the analysis. The score is calculated using the following formula:</li>
</ol>
<ul>
<li>algn_seq1seq2 / (sqrt(algn_seq1seq1) * sqrt(algn_seq2seq2))<br>
This formula was first proposed by Bleakley and Yamanashi and is a way to normalize the score by the length of the alignment. The output will be a dataframe containing the score of each pairwise alignment among all sequences provided.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">score_file</span> <span class="op">&lt;-</span> <span class="fu">dgfr</span><span class="fu">::</span><span class="fu"><a href="reference/get_alignment_score.html">get_alignment_score</a></span><span class="op">(</span>fasta <span class="op">=</span> <span class="va">tcmuc_fasta</span>,</span>
<span>                                        type <span class="op">=</span> <span class="st">"prot"</span>,</span>
<span>                                        alignment_method <span class="op">=</span> <span class="st">"global"</span>,</span>
<span>                                        cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1/6] Loading substitution matrix...</span></span>
<span><span class="co">#&gt; [2/6] Loading fasta file...</span></span>
<span><span class="co">#&gt; [3/6] Creating all possible sequence combinations...</span></span>
<span><span class="co">#&gt; [4/6] Performing pairwise alignment for prot sequences. This might take a while...</span></span>
<span><span class="co">#&gt; [5/6] Finishing up...</span></span>
<span><span class="co">#&gt; [6/6] Pairwise alignment is done.</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>The output of the first function of the package, should be provided to the second function called <code>create_distance_matrix</code>. This function calculates the average Euclidian distance between the score of each pairwise alignment.</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distance_matrix</span> <span class="op">&lt;-</span> <span class="fu">dgfr</span><span class="fu">::</span><span class="fu"><a href="reference/create_distance_matrix.html">create_distance_matrix</a></span><span class="op">(</span>score_file <span class="op">=</span> <span class="va">score_file</span><span class="op">)</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>After generating the distance matrix, we will use the <code>get_variance</code> function to access the variability explained by each axis. This requires the provision of the file containing the distance matrix. In general, a cumulative value of 70% or higher for the axis is considered adequate for explaining the data’s variance.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variance</span> <span class="op">&lt;-</span> <span class="fu">dgfr</span><span class="fu">::</span><span class="fu"><a href="reference/get_variance.html">get_variance</a></span><span class="op">(</span>distance_matrix <span class="op">=</span> <span class="va">distance_matrix</span><span class="op">)</span></span>
<span><span class="va">variance</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span><span class="co">#&gt;     `1`   `2`   `3`</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  81.7  10.5  3.34</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>The subsequent required step consists of a multidimensional scaling (MDS) of the data matrix. The output will consist of the name of the sequence and its position on axes 1 and 2.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dim_reduced_file</span> <span class="op">&lt;-</span> <span class="fu">dgfr</span><span class="fu">::</span><span class="fu"><a href="reference/dim_reduction.html">dim_reduction</a></span><span class="op">(</span>distance_matrix <span class="op">=</span> <span class="va">distance_matrix</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dim_reduced_file</span><span class="op">)</span></span>
<span><span class="co">#&gt;                          axis_1     axis_2</span></span>
<span><span class="co">#&gt; TcYC6_0150500-RA-p1  0.01410299 0.08506485</span></span>
<span><span class="co">#&gt; TcYC6_0150510-RA-p1 -1.10954550 0.30707240</span></span>
<span><span class="co">#&gt; TcYC6_0150520-RA-p1 -0.97152461 0.20716940</span></span>
<span><span class="co">#&gt; TcYC6_0150530-RA-p1 -1.13936354 0.29036688</span></span>
<span><span class="co">#&gt; TcYC6_0150540-RA-p1 -0.73347654 0.01002143</span></span>
<span><span class="co">#&gt; TcYC6_0150550-RA-p1  0.43034170 0.19684138</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>A possible functionality of the dgfr package is to determine the optimal number of clusters in the dataset. You must provide the dimension-reduced file and, if desired, the minimum and maximum number of clusters to be identified. If you do not provide these values, the script will automatically search between 2 and 20 clusters.</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kmeans_output</span> <span class="op">&lt;-</span> <span class="fu">dgfr</span><span class="fu">::</span><span class="fu"><a href="reference/kmeans_clustering.html">kmeans_clustering</a></span><span class="op">(</span>dim_reduced_file <span class="op">=</span> <span class="va">dim_reduced_file</span><span class="op">)</span></span></code></pre></div>
<p>Finally, you will have a table containing the name of each sequence, its position on axes 1 and 2, and the cluster to which the sequence belongs.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">kmeans_output</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  name      axis_1     axis_2 cluster</span></span>
<span><span class="co">#&gt; 1 TcYC6_0150500-RA-p1  0.01410299 0.08506485       1</span></span>
<span><span class="co">#&gt; 2 TcYC6_0150510-RA-p1 -1.10954550 0.30707240       1</span></span>
<span><span class="co">#&gt; 3 TcYC6_0150520-RA-p1 -0.97152461 0.20716940       1</span></span>
<span><span class="co">#&gt; 4 TcYC6_0150530-RA-p1 -1.13936354 0.29036688       1</span></span>
<span><span class="co">#&gt; 5 TcYC6_0150540-RA-p1 -0.73347654 0.01002143       1</span></span>
<span><span class="co">#&gt; 6 TcYC6_0150550-RA-p1  0.43034170 0.19684138       1</span></span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>The next function, allows you to visualize the sequences and its cluster in a tree-like structure. You must provide the <code>kmeans_clustering</code> function output and the <code>create_distance_matrix</code> output. The output will be a plot containing the sequences and its cluster.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">dgfr</span><span class="fu">::</span><span class="fu"><a href="reference/create_tree.html">create_tree</a></span><span class="op">(</span>distance_matrix <span class="op">=</span> <span class="va">distance_matrix</span>,</span>
<span>                kmeans_output <span class="op">=</span> <span class="va">kmeans_output</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tree</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="60%" style="display: block; margin: auto;"></p>
<ol start="8" style="list-style-type: decimal">
<li>Finally, you can access the mean/median similarity among each cluster using the function <code>similarity_cluster</code>. This function takes as argument the <code>kmeans_clustering</code> function output, the <code>get_alignment_score</code> output and you must also choose between two possible visualizations output. The “table” output returns a table containing the mean and median similarity among all clusters and the number of genes inside each cluster.</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dgfr</span><span class="fu">::</span><span class="fu"><a href="reference/similarity_cluster.html">similarity_cluster</a></span><span class="op">(</span>score_file <span class="op">=</span> <span class="va">score_file</span>,</span>
<span>                         kmeans_output <span class="op">=</span> <span class="va">kmeans_output</span>,</span>
<span>                         output_type <span class="op">=</span> <span class="st">"table"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 4</span></span>
<span><span class="co">#&gt;   cluster   mean_similarity median_similarity number_of_genes</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;               &lt;dbl&gt;             &lt;dbl&gt;           &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 cluster_1           0.509             0.503             391</span></span>
<span><span class="co">#&gt; 2 cluster_2           0.756             0.707              49</span></span>
<span><span class="co">#&gt; 3 cluster_3           0.434             0.260              36</span></span></code></pre></div>
<p>The “plot” output returns a plot containing a violin plot highlighting the distribution of similarity within each cluster.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dgfr</span><span class="fu">::</span><span class="fu"><a href="reference/similarity_cluster.html">similarity_cluster</a></span><span class="op">(</span>score_file <span class="op">=</span> <span class="va">score_file</span>,</span>
<span>                         kmeans_output <span class="op">=</span> <span class="va">kmeans_output</span>,</span>
<span>                         output_type <span class="op">=</span> <span class="st">"plot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-14-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="data-visualisation-suggestions">Data visualisation suggestions<a class="anchor" aria-label="anchor" href="#data-visualisation-suggestions"></a>
</h2>
<p>All visualization suggestions presented here were created using the <code>ggplot2</code> package. However, you are allowed to use your preferred package or tool to visualize the obtained data.</p>
<div class="section level3">
<h3 id="visualizing-gene-family-dispersion">Visualizing gene family dispersion<a class="anchor" aria-label="anchor" href="#visualizing-gene-family-dispersion"></a>
</h3>
<p>The simplest form of visualization is the scatter plot of sequences from a particular gene family, where each point represents a sequence, and the distance between two points is proportional to the similarity of these sequences.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kmeans_output</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">axis_1</span>, </span>
<span>                 y <span class="op">=</span> <span class="va">axis_2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3.5</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">variance</span><span class="op">$</span><span class="va">`1`</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>                y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">variance</span><span class="op">$</span><span class="va">`2`</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-15-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="identifying-particular-sequences-within-the-gene-family">Identifying particular sequences within the gene family<a class="anchor" aria-label="anchor" href="#identifying-particular-sequences-within-the-gene-family"></a>
</h3>
<p>The second suggested plot is similar to the first, but it allows for the highlighting of sequences of interest. In addition to <code>ggplot2</code>, <code>gghighlight</code> and <code>ggrepel</code> are required to perform this analysis.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seq_name</span> <span class="op">&lt;-</span> <span class="va">kmeans_output</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html" class="external-link">sample_n</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kmeans_output</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">axis_1</span>, </span>
<span>                 y <span class="op">=</span> <span class="va">axis_2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3.5</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">variance</span><span class="op">$</span><span class="va">`1`</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>                y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">variance</span><span class="op">$</span><span class="va">`2`</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">gghighlight</span><span class="fu">::</span><span class="fu"><a href="https://yutannihilation.github.io/gghighlight/reference/gghighlight.html" class="external-link">gghighlight</a></span><span class="op">(</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">seq_name</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">seq_name</span>, </span>
<span>                           min.segment.length <span class="op">=</span> <span class="fl">0</span>, </span>
<span>                           seed <span class="op">=</span> <span class="fl">42</span>, </span>
<span>                           box.padding <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-16-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="identifying-the-number-of-clusters-within-the-gene-family">Identifying the number of clusters within the gene family<a class="anchor" aria-label="anchor" href="#identifying-the-number-of-clusters-within-the-gene-family"></a>
</h3>
<p>In this third visualization suggestion, the gene family is divided into an optimal number of groups, each of which represented by a different color.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kmeans_output</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">axis_1</span>, </span>
<span>                 y <span class="op">=</span> <span class="va">axis_2</span>,</span>
<span>                 color <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3.5</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">variance</span><span class="op">$</span><span class="va">`1`</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>                y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">variance</span><span class="op">$</span><span class="va">`2`</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-17-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="aggregating-and-visualizing-rnaseq-data">Aggregating and visualizing RNAseq data<a class="anchor" aria-label="anchor" href="#aggregating-and-visualizing-rnaseq-data"></a>
</h3>
<p>Another functionality is to integrate RNAseq data to visualize the expression and dispersion of the gene family in the scatter plot. The size of the points is proportional to the gene expression level of each family member, with small points representing genes with low expression and large points representing genes with high expression.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kmeans_out_l2fc</span> <span class="op">&lt;-</span> <span class="va">kmeans_output</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>l2fc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">476</span>, min <span class="op">=</span> <span class="fl">0.1</span>, max <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kmeans_out_l2fc</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">axis_1</span>, </span>
<span>                 y <span class="op">=</span> <span class="va">axis_2</span>,</span>
<span>                 color <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">kmeans_out_l2fc</span><span class="op">$</span><span class="va">l2fc</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">variance</span><span class="op">$</span><span class="va">`1`</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>                y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">variance</span><span class="op">$</span><span class="va">`2`</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-18-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="warranty">Warranty<a class="anchor" aria-label="anchor" href="#warranty"></a>
</h2>
<p>If you find any bugs or incorrect information, please open an issue.</p>
</div>
<div class="section level2">
<h2 id="acknowledgment">Acknowledgment<a class="anchor" aria-label="anchor" href="#acknowledgment"></a>
</h2>
<p>The development of this package would not have been possible without the knowledge shared by the instructors at <a href="https://github.com/curso-r" class="external-link">curso-R</a>, mainly Beatriz Milz, Caio Lente and Júlio Trecenti.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/lailaviana/dgfr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/lailaviana/dgfr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing dgfr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Laila Viana <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-7957-2196" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Laila Viana.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
